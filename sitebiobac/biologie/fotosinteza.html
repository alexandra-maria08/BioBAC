<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link rel="manifest" href="/manifest.json">
<title>BioBAC â€“ LecÈ›ia: Fotosinteza</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Activare dark mode din localStorage -->
<script>
    if (localStorage.getItem('tema') === 'dark') {
      document.documentElement.classList.add('dark');
    }
</script>

<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #e8f5e9;
    padding: 20px;
    margin: 0;
    color: #000;
  }
  .container {
    max-width: 800px;
    background: white;
    padding: 20px;
    margin: auto;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    position: relative;
  }
  h1, h2 { color: #1b5e20; }
  ul { text-align: left; }
  .intrebare { margin: 15px 0; text-align: left; }
  .raspunsuri button {
    display: block;
    margin: 5px 0;
    padding: 8px;
    width: 100%;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
    background-color: #f0f0f0;
    color: #000;
  }
  .raspunsuri button.corect {
    background-color: #c8e6c9;
    color: #2e7d32;
    border: none;
  }
  .raspunsuri button.gresit {
    background-color: #ffcdd2;
    color: #c62828;
    border: none;
  }
  .feedback { font-weight: bold; margin-top: 10px; }
  input[type=text], select {
    width: 100%;
    padding: 8px;
    margin: 5px 0;
  }
  a.back {
    display: inline-block;
    margin-top: 20px;
    color: #1b5e20;
    font-weight: bold;
    text-decoration: none;
  }
  .rezultat {
    background-color: #fff9c4;
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
    font-size: 18px;
  }

  /* Google Translate container */
  #google_translate_element {
    position: absolute;
    top: 15px;
    right: 20px;
    z-index: 10;
    text-align: right;
  }

  /* DARK MODE */
  .dark body, .dark {
    background-color: #121212 !important;
    color: #e0e0e0 !important;
  }
  .dark .container {
    background-color: #1e1e1e !important;
    box-shadow: 0 0 10px rgba(255,255,255,0.1) !important;
  }
  .dark .raspunsuri button {
    background-color: #2c2c2c !important;
    color: white !important;
  }
  .dark .raspunsuri button.corect {
    background-color: #388e3c !important;
    color: white !important;
    border: none !important;
  }
  .dark .raspunsuri button.gresit {
    background-color: #d32f2f !important;
    color: white !important;
    border: none !important;
  }
  .dark .rezultat { background-color: #333 !important; }
  .dark a.back { color: #81c784 !important; }

  /* Google Translate styling */
  .goog-te-banner-frame.skiptranslate {
    display: none !important;
  }
  body { top: 0 !important; }

  #google_translate_element {
  margin-top: 5px;
}

#tts-button {
  background-color: #1b5e20;
  color: white;
  border: none;
  border-radius: 6px;
  padding: 8px 16px;
  cursor: pointer;
  font-weight: bold;
  margin: 10px 0;
}
.dark #tts-button {
  background-color: #81c784;
  color: #121212;
}
</style>
</head>
<body>
<div class="container">

  <!-- Google Translate -->
  <div id="google_translate_element"></div>

  <div style="display: flex; justify-content: space-between; align-items: flex-start;">
  <button id="tts-button" title="AscultÄƒ teoria esenÈ›ialÄƒ">ğŸ”Š AscultÄƒ</button>
  <div id="google_translate_element"></div>
</div>
<h1>ğŸŒ¿ BioBAC â€“ LecÈ›ia: Fotosinteza</h1>

  <h2>ğŸ§  Teorie esenÈ›ialÄƒ</h2>
  <div id="teorie-esentiala">
    <ul>
      <li>Fotosinteza este procesul biologic fundamental prin care organismele fotosintetice (plante, alge, unele bacterii) transformÄƒ energia solarÄƒ Ã®n energie chimicÄƒ sub formÄƒ de glucozÄƒ.</li>
      <li>Procesul se desfÄƒÈ™oarÄƒ Ã®n organitele specializate numite <strong>cloroplaste</strong>, prezente Ã®n celulele vegetale:
        <ul>
          <li><strong>Cloroplasta</strong> - organita celularÄƒ cu dublÄƒ membranÄƒ care conÈ›ine clorofila</li>
          <li><strong>Tilacoizii</strong> - structuri membranare Ã®n formÄƒ de saci unde se aflÄƒ pigmenÈ›ii fotosintetici</li>
          <li><strong>Grana</strong> - structuri formate din mai mulÈ›i tilacoizi suprapuÈ™i</li>
          <li><strong>Stroma</strong> - substanÈ›a Ã®n care sunt Ã®nconjuraÈ›i tilacoizii, conÈ›ine enzime pentru sinteza glucozei</li>
        </ul>
      </li>
      <li>Fotosinteza se realizeazÄƒ Ã®n douÄƒ faze distincte dar interdependente:
        <ul>
          <li><strong>Faza luminoasÄƒ (fotochimicÄƒ)</strong> - are loc Ã®n membrana tilacoizilor Ã®n prezenÈ›a luminii solare</li>
          <li><strong>Faza Ã®ntunecatÄƒ (biochimicÄƒ)</strong> - se desfÄƒÈ™oarÄƒ Ã®n stroma cloroplastei, nu necesitÄƒ direct lumina</li>
        </ul>
      </li>
      <li>PigmenÈ›ii fotosintetici sunt molecule care absorb energia luminoasÄƒ:
        <ul>
          <li><strong>Clorofila a</strong> - pigmentul principal, absoarbe lumina roÈ™ie È™i albastru-violet</li>
          <li><strong>Clorofila b</strong> - pigment accesoriu, extinde spectrul de absorbÈ›ie</li>
          <li><strong>Carotenoizii</strong> - pigmenÈ›i galbeni È™i oranjii, protejeazÄƒ clorofila de degradare</li>
          <li><strong>Xantofilele</strong> - pigmenÈ›i galbeni care participÄƒ la captarea luminii</li>
        </ul>
      </li>
      <li>Faza luminoasÄƒ cuprinde urmÄƒtoarele etape:
        <ul>
          <li><strong>AbsorbÈ›ia luminii</strong> - clorofila capteazÄƒ fotoni È™i excitÄƒ electronii</li>
          <li><strong>FotolizÄƒ apei</strong> - descompunerea moleculelor de Hâ‚‚O Ã®n hidrogen È™i oxigen</li>
          <li><strong>Producerea ATP</strong> - sinteza adenozin trifosfatului, sursa principalÄƒ de energie</li>
          <li><strong>Formarea NADPH</strong> - coenzimÄƒ care transportÄƒ electronii È™i hidrogenul</li>
          <li><strong>Eliberarea oxigenului</strong> - Oâ‚‚ se elibereazÄƒ ca produs secundar Ã®n atmosferÄƒ</li>
        </ul>
      </li>
      <li>Faza Ã®ntunecatÄƒ (Ciclul Calvin-Benson) include:
        <ul>
          <li><strong>Fixarea carbonului</strong> - COâ‚‚ din atmosferÄƒ se combinÄƒ cu ribuloza-1,5-bisfosfat</li>
          <li><strong>Reducerea carbonului</strong> - folosind ATP È™i NADPH din faza luminoasÄƒ</li>
          <li><strong>Regenerarea ribulozei</strong> - pentru continuarea ciclului</li>
          <li><strong>Formarea glucozei</strong> - produsul final al fotosintezei (Câ‚†Hâ‚â‚‚Oâ‚†)</li>
        </ul>
      </li>
      <li>EcuaÈ›ia chimicÄƒ completÄƒ a fotosintezei:
        <ul>
          <li><strong>6COâ‚‚ + 6Hâ‚‚O + energie luminoasÄƒ â†’ Câ‚†Hâ‚â‚‚Oâ‚† + 6Oâ‚‚ + 6Hâ‚‚O</strong></li>
          <li>SubstanÈ›ele iniÈ›iale: dioxid de carbon, apÄƒ, energia solarÄƒ</li>
          <li>Produsele finale: glucoza, oxigenul, apa</li>
        </ul>
      </li>
      <li>Factorii care influenÈ›eazÄƒ intensitatea fotosintezei:
        <ul>
          <li><strong>Intensitatea luminii</strong> - mai multÄƒ luminÄƒ creÈ™te rata fotosintezei pÃ¢nÄƒ la un punct de saturaÈ›ie</li>
          <li><strong>ConcentraÈ›ia COâ‚‚</strong> - mai mult dioxid de carbon accelereazÄƒ procesul</li>
          <li><strong>Temperatura</strong> - temperaturi optime (20-30Â°C) pentru activitatea enzimelor</li>
          <li><strong>Disponibilitatea apei</strong> - apa este necesarÄƒ pentru fotoliza È™i transportul substanÈ›elor</li>
          <li><strong>ConcentraÈ›ia clorofilei</strong> - mai mult pigment Ã®nseamnÄƒ mai multÄƒ absorbÈ›ie de luminÄƒ</li>
        </ul>
      </li>
      <li>ImportanÈ›a biologicÄƒ È™i ecologicÄƒ a fotosintezei:
        <ul>
          <li><strong>ProducÈ›ia de oxigen</strong> - 70% din oxigenul atmosferic provine din fotosintezÄƒ</li>
          <li><strong>Baza lanÈ›urilor trofice</strong> - plantele sunt producÄƒtorii primari Ã®n ecosisteme</li>
          <li><strong>Ciclul carbonului</strong> - Ã®ndepÄƒrteazÄƒ COâ‚‚ din atmosferÄƒ, reducÃ¢nd efectul de serÄƒ</li>
          <li><strong>Stocarea energiei</strong> - converteÈ™te energia solarÄƒ Ã®n forme utilizabile de organisme</li>
        </ul>
      </li>
      <li>RelaÈ›ia dintre fotosintezÄƒ È™i respiraÈ›ia celularÄƒ:
        <ul>
          <li><strong>Procese complementare</strong> - fotosinteza produce glucozÄƒ, respiraÈ›ia o descompune</li>
          <li><strong>Schimbul de gaze</strong> - fotosinteza consumÄƒ COâ‚‚ È™i produce Oâ‚‚, respiraÈ›ia face invers</li>
          <li><strong>Ciclul diurn</strong> - ziua predominÄƒ fotosinteza, noaptea respiraÈ›ia</li>
          <li><strong>Echilibrul energetic</strong> - plantele Ã®È™i satisfac nevoile energetice prin ambele procese</li>
        </ul>
      </li>
      <li>Tipuri speciale de fotosintezÄƒ:
        <ul>
          <li><strong>Fotosinteza Câ‚„</strong> - adaptare la climatul tropical, mai eficientÄƒ la temperaturi ridicate</li>
          <li><strong>Fotosinteza CAM</strong> - specificÄƒ plantelor de deÈ™ert, deschid stomatele noaptea</li>
          <li><strong>Fotosinteza bacterianÄƒ</strong> - foloseÈ™te alÈ›i donatori de electroni decÃ¢t apa</li>
        </ul>
      </li>
      <li>AplicaÈ›ii practice È™i tehnologice:
        <ul>
          <li><strong>Agricultura</strong> - optimizarea condiÈ›iilor pentru creÈ™terea randamentului culturilor</li>
          <li><strong>Fotosinteza artificialÄƒ</strong> - tehnologii pentru producerea de combustibili solari</li>
          <li><strong>Monitorizarea mediului</strong> - folosirea fotosintezei ca indicator al sÄƒnÄƒtÄƒÈ›ii ecosistemelor</li>
          <li><strong>Biotehnologia</strong> - modificarea plantelor pentru eficienÈ›Äƒ fotosintezei Ã®mbunÄƒtÄƒÈ›itÄƒ</li>
        </ul>
      </li>
    </ul>
  </div>

  <h2>ğŸ“ Test â€“ 9 itemi</h2>

  <!-- ExerciÈ›ii -->
  <div class="intrebare"><p><strong>1. Ce pigment principal este implicat Ã®n fotosintezÄƒ?</strong></p>
    <div class="raspunsuri">
      <button onclick="verifica(this, true)">Clorofila</button>
      <button onclick="verifica(this, false)">Melanina</button>
      <button onclick="verifica(this, false)">Hemoglobina</button>
      <button onclick="verifica(this, false)">Karoten</button>
    </div>
  </div>

  <div class="intrebare"><p><strong>2. Unde are loc faza Ã®ntunecatÄƒ?</strong></p>
    <div class="raspunsuri">
      <button onclick="verifica(this, true)">StromÄƒ</button>
      <button onclick="verifica(this, false)">Tilacoide</button>
      <button onclick="verifica(this, false)">Nucleu</button>
      <button onclick="verifica(this, false)">CitoplasmÄƒ</button>
    </div>
  </div>

  <div class="intrebare"><p><strong>3. CompleteazÄƒ: Glucoza este produsÄƒ Ã®n faza __________ a fotosintezei.</strong></p>
    <input id="c1" type="text"/>
    <button onclick="verificaCompletare('c1', 'Ã®ntunecatÄƒ')">VerificÄƒ</button>
    <p class="feedback" id="f1"></p>
  </div>

  <div class="intrebare"><p><strong>4. Alege componentele implicate Ã®n faza luminoasÄƒ:</strong></p>
    <label><input id="v1" type="checkbox"> Tilacoide</input></label><br/>
    <label><input id="v2" type="checkbox"/> StromÄƒ</label><br/>
    <label><input id="v3" type="checkbox"/> ClorofilÄƒ</label><br/>
    <label><input id="v4" type="checkbox"/> Nucleu</label><br/>
    <button onclick="verificaCheckbox()">VerificÄƒ</button>
    <p class="feedback" id="f2"></p>
  </div>

  <div class="intrebare"><p><strong>5. CompleteazÄƒ: Gazul eliberat Ã®n timpul fotosintezei este __________.</strong></p>
    <input id="c2" type="text"/>
    <button onclick="verificaCompletare('c2', 'oxigen')">VerificÄƒ</button>
    <p class="feedback" id="f3"></p>
  </div>

  <div class="intrebare"><p><strong>6. Ce este fotosinteza?</strong></p>
    <input id="c3" type="text"/>
    <button onclick="verificaScurt('c3')">VerificÄƒ</button>
    <p class="feedback" id="f4"></p>
  </div>

  <div class="intrebare"><p><strong>7. AsociazÄƒ componentele cu rolul lor:</strong></p>
    <label>Tilacoide â†’
      <select id="a1">
        <option value="">SelecteazÄƒ</option>
        <option value="luminoasa">Faza luminoasÄƒ</option>
        <option value="intunecata">Faza Ã®ntunecatÄƒ</option>
      </select>
    </label><br/>
    <label>StromÄƒ â†’
      <select id="a2">
        <option value="">SelecteazÄƒ</option>
        <option value="luminoasa">Faza luminoasÄƒ</option>
        <option value="intunecata">Faza Ã®ntunecatÄƒ</option>
      </select>
    </label><br/>
    <button onclick="verificaAsociere()">VerificÄƒ</button>
    <p class="feedback" id="f5"></p>
  </div>

  <div class="intrebare"><p><strong>8. CompleteazÄƒ: Fotosinteza are loc doar Ã®n prezenÈ›a __________ È™i luminÄƒ.</strong></p>
    <input id="c4" type="text"/>
    <button onclick="verificaCompletare('c4', 'clorofilei')">VerificÄƒ</button>
    <p class="feedback" id="f6"></p>
  </div>

  <div class="intrebare"><p><strong>9. AsociazÄƒ fiecare componentÄƒ cu rolul sÄƒu:</strong></p>
    <label>Clorofila â†’
      <select id="a3">
        <option value="">SelecteazÄƒ</option>
        <option value="absorbtie">AbsorbÈ›ia luminii</option>
        <option value="eliberare">Eliberarea oxigenului</option>
      </select>
    </label><br/>
    <label>Oxigen â†’
      <select id="a4">
        <option value="">SelecteazÄƒ</option>
        <option value="absorbtie">AbsorbÈ›ia luminii</option>
        <option value="eliberare">Eliberarea oxigenului</option>
      </select>
    </label><br/>
    <button onclick="verificaAsociereExtra()">VerificÄƒ</button>
    <p class="feedback" id="f7"></p>
  </div>

  <button onclick="afiseazaFeedbackFinal()">âœ… Vezi rezultatul final</button>
  <p class="rezultat" id="rezultatFinal"></p>
  <a class="back" href="../index.html">â† Ãnapoi la meniu</a>
</div>

<script>
let scor = 0;
let completari = {};

function verifica(elem, corect) {
  elem.disabled = true;
  elem.classList.remove('corect', 'gresit');
  elem.classList.add(corect ? 'corect' : 'gresit');
  elem.parentElement.querySelectorAll('button').forEach(b => b.disabled = true);
  if (corect) scor++;
}

function verificaCompletare(id, rasp) {
  const val = document.getElementById(id).value.trim().toLowerCase();
  const f = document.getElementById('f' + id.slice(1));
  const esteCorect = val === rasp.toLowerCase();
  f.innerText = esteCorect ? 'âœ”ï¸ Corect' : `âŒ RÄƒspuns corect: ${rasp}`;
  f.style.color = esteCorect ? 'green' : 'red';
  if (!completari[id] && esteCorect) { scor++; completari[id] = true; }
}

function verificaCheckbox() {
  const r = [true, false, true, false]; // Tilacoide, StromÄƒ, ClorofilÄƒ, Nucleu
  const a = [v1.checked, v2.checked, v3.checked, v4.checked];
  const f = document.getElementById('f2');
  const e = JSON.stringify(r) === JSON.stringify(a);
  f.innerText = e ? 'âœ”ï¸ Corect' : 'âŒ VerificÄƒ componentele implicate Ã®n faza luminoasÄƒ.';
  f.style.color = e ? 'green' : 'red';
  if (e && !completari['luminoasa']) { scor++; completari['luminoasa'] = true; }
}

function verificaScurt(id) {
  const val = document.getElementById(id).value.trim().toLowerCase();
  const f = document.getElementById('f4');
  const esteCorect = val.includes("energie") && val.includes("solar") && val.includes("chemic");
  f.innerText = esteCorect ? 'âœ”ï¸ Corect' : 'âŒ RÄƒspuns corect: Procesul de transformare a energiei solare Ã®n energie chimicÄƒ.';
  f.style.color = esteCorect ? 'green' : 'red';
  if (esteCorect && !completari[id]) { scor++; completari[id] = true; }
}

function verificaAsociere() {
  const a1 = document.getElementById('a1').value;
  const a2 = document.getElementById('a2').value;
  const f = document.getElementById('f5');
  const e = a1 === 'luminoasa' && a2 === 'intunecata';
  f.innerText = e ? 'âœ”ï¸ Corect' : 'âŒ Tilacoide â†’ luminoasÄƒ, StromÄƒ â†’ Ã®ntunecatÄƒ';
  f.style.color = e ? 'green' : 'red';
  if (e && !completari['asociere1']) { scor++; completari['asociere1'] = true; }
}

function verificaAsociereExtra() {
  const a3 = document.getElementById('a3').value;
  const a4 = document.getElementById('a4').value;
  const f = document.getElementById('f7');
  const e = a3 === 'absorbtie' && a4 === 'eliberare';
  f.innerText = e ? 'âœ”ï¸ Corect' : 'âŒ Clorofila â†’ absorbÈ›ie, Oxigen â†’ eliberare';
  f.style.color = e ? 'green' : 'red';
  if (e && !completari['asociere2']) { scor++; completari['asociere2'] = true; }
}

async function adaugaXP(puncte) {
  const user = auth.currentUser;
  if (!user) {
    console.log("Nu eÈ™ti logat, nu se poate salva progresul.");
    return;
  }
  const uid = user.uid;
  const docRef = db.collection("progres_utilizatori").doc(uid);
  try {
    const doc = await docRef.get();
    if (!doc.exists) {
      await docRef.set({ nivel: 1, xp: 0 });
    }
    let data = (await docRef.get()).data();
    let xp = data.xp || 0;
    let nivel = data.nivel || 1;
    const maxXp = nivel * 100;

    xp += puncte;

    if (xp >= maxXp) {
      nivel++;
      xp = xp - maxXp;
      alert(`FelicitÄƒri! Ai urcat la nivelul ${nivel}!`);
    }

    await docRef.update({ nivel, xp });
    console.log(`Progres salvat: Nivel ${nivel}, XP ${xp}/${nivel*100}`);
  } catch (e) {
    console.error("Eroare salvare progres:", e);
  }
}

function afiseazaFeedbackFinal() {
  const procent = (scor / 9) * 100;
  let mesaj = '';
  if (procent >= 90) mesaj = 'ğŸŒŸ Excelent! Ai Ã®nÈ›eles foarte bine materia!';
  else if (procent >= 70) mesaj = 'ğŸ‘ Bine! Mai exerseazÄƒ cÃ¢teva concepte.';
  else if (procent >= 50) mesaj = 'ğŸ™‚ Mai este loc de Ã®mbunÄƒtÄƒÈ›ire. ReciteÈ™te lecÈ›ia.';
  else mesaj = 'âš ï¸ ÃÈ›i recomandÄƒm sÄƒ reiei teoria pas cu pas.';
  document.getElementById('rezultatFinal').innerText = `${mesaj} Ai obÈ›inut ${scor} din 9 rÄƒspunsuri corecte.`;

  const xpDeAdaugat = scor * 10; // 10 XP pe rÄƒspuns corect
  adaugaXP(xpDeAdaugat);
}

// Google Translate init
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'ro',
    includedLanguages: 'en,hu',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
  }, 'google_translate_element');
}

// Service Worker (PWA)
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/sw.js")
    .then(reg => console.log("âœ… Service Worker activat!", reg))
    .catch(err => console.error("âŒ Eroare la SW:", err));
}

// Firebase config È™i iniÈ›ializare
const firebaseConfig = {
  apiKey: "AIzaSyA5C-UQTHOO7CFrbzV7vMXfQTrM1iz0_CE",
  authDomain: "biobac-cont.firebaseapp.com",
  projectId: "biobac-cont",
  storageBucket: "biobac-cont.appspot.com",
  messagingSenderId: "59421729279",
  appId: "1:59421729279:web:142fbafcc1f22c9b5ac7ca"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Text-to-Speech (TTS)
const ttsButton = document.getElementById('tts-button');
let synth = window.speechSynthesis;
let voceCitita = false;

ttsButton.addEventListener('click', () => {
  if (voceCitita) {
    synth.cancel();
    ttsButton.textContent = "ğŸ”Š AscultÄƒ";
    voceCitita = false;
  } else {
    let text = document.getElementById('teorie-esentiala').innerText;
    let utterThis = new SpeechSynthesisUtterance(text);
    utterThis.lang = 'ro-RO';
    utterThis.rate = 1;
    utterThis.pitch = 1;
    utterThis.onend = () => {
      ttsButton.textContent = "ğŸ”Š AscultÄƒ";
      voceCitita = false;
    };
    synth.speak(utterThis);
    ttsButton.textContent = "â¸ï¸ OpreÈ™te";
    voceCitita = true;
  }
});
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script src="settings.js"></script>
</body>
</html>