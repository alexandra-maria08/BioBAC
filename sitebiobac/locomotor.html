<!DOCTYPE html>

<html lang="ro">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link rel="manifest" href="/manifest.json">
<title>BioBAC â€“ Sistemul locomotor</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Activare dark mode din localStorage -->
<script>
    if (localStorage.getItem('tema') === 'dark') {
      document.documentElement.classList.add('dark');
    }
</script>
<style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fff8e1;
      margin: 0;
      padding: 20px;
      color: #000;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      position: relative;
    }
    h1, h2 { color: #ff6f00; }
    ul { text-align: left; }
    .intrebare { margin: 15px 0; text-align: left; }
    .raspunsuri button {
      width: 100%;
      margin: 5px 0;
      padding: 10px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background-color: #f0f0f0;
      color: #000;
      transition: background-color 0.3s ease;
    }
    .raspunsuri button.corect {
      background-color: #c8e6c9;
      color: #2e7d32;
      border: none;
    }
    .raspunsuri button.gresit {
      background-color: #ffcdd2;
      color: #c62828;
      border: none;
    }
    .feedback { font-weight: bold; margin-top: 10px; }
    input[type=text], select {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
    }
    a.back {
      display: inline-block;
      margin-top: 20px;
      color: #ff6f00;
      font-weight: bold;
      text-decoration: none;
    }
    .rezultat {
      background-color: #fff9c4;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
      font-size: 18px;
    }

    /* Google Translate container */
    #google_translate_element {
      position: absolute;
      top: 15px;
      right: 20px;
      z-index: 10;
      text-align: right;
    }

    /* DARK MODE */
    .dark body, .dark {
      background-color: #121212 !important;
      color: #e0e0e0 !important;
    }
    .dark .container {
      background-color: #1e1e1e !important;
      box-shadow: 0 0 10px rgba(255,255,255,0.1) !important;
    }
    .dark .raspunsuri button {
      background-color: #2c2c2c !important;
      color: white !important;
    }
    .dark .raspunsuri button.corect {
      background-color: #388e3c !important;
      color: white !important;
      border: none !important;
    }
    .dark .raspunsuri button.gresit {
      background-color: #d32f2f !important;
      color: white !important;
      border: none !important;
    }
    .dark .rezultat { background-color: #333 !important; }
    .dark a.back { color: #ffcc80 !important; }

    /* Google Translate styling */
    .goog-te-banner-frame.skiptranslate {
      display: none !important;
    }
    body { top: 0 !important; }

    #google_translate_element {
      margin-top: 5px;
    }

    #tts-button {
      background-color: #ff6f00;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      cursor: pointer;
      font-weight: bold;
      margin: 10px 0;
    }
    .dark #tts-button {
      background-color: #ffcc80;
      color: #121212;
    }

    .info-box {
      background-color: #fff8e1;
      border-left: 4px solid #ff6f00;
      padding: 15px;
      margin: 15px 0;
      border-radius: 5px;
    }
    .dark .info-box {
      background-color: #2d2d2d;
      border-left-color: #ffcc80;
    }
  </style>
<script async="" data-goatcounter="https://biobac.goatcounter.com/count" src="//gc.zgo.at/count.js"></script>
</head>
<body>
<div class="container">

  <!-- Google Translate -->
  <div id="google_translate_element"></div>

  <div style="display: flex; justify-content: space-between; align-items: flex-start;">
    <button id="tts-button" title="AscultÄƒ teoria esenÈ›ialÄƒ">ğŸ”Š AscultÄƒ</button>
    <div id="google_translate_element"></div>
  </div>

<h1>ğŸ’ª BioBAC â€“ Sistemul locomotor</h1>

<h2>ğŸ§  Teorie esenÈ›ialÄƒ</h2>
<div id="teorie-esentiala">
<ul>
<li>Sistemul locomotor este alcÄƒtuit din:
        <ul>
<li><strong>Scheletul</strong> â€“ oferÄƒ susÈ›inere È™i protecÈ›ie organelor</li>
<li><strong>Sistemul muscular</strong> â€“ permite miÈ™carea prin contracÈ›ie</li>
</ul>
</li>
<li>Oasele sunt unite prin <strong>articulaÈ›ii</strong>.</li>
<li>Sistemul muscular este format din muÈ™chi striaÈ›i, netezi È™i muÈ™chiul cardiac.</li>
<li>MiÈ™carea voluntarÄƒ este controlatÄƒ de sistemul nervos somatic.</li>
<li>Scheletul uman adult conÈ›ine aproximativ 206 de oase la maturitate.</li>
<li>Oasele sunt È›esut viu care se remodeleaza constant prin procesele de resorbtie È™i formare osoasÄƒ.</li>
<li>Tendonii leagÄƒ muÈ™chii de oase, Ã®n timp ce ligamentele leagÄƒ oasele Ã®ntre ele.</li>
<li>ArticulaÈ›iile mobile (sinoviale) permit miÈ™cÄƒri complexe È™i sunt lubrifiate de lichidul sinovial.</li>
<li>MuÈ™chii lucreazÄƒ Ã®n perechi antagoniste: cÃ¢nd unul se contractÄƒ, celÄƒlalt se relaxeazÄƒ.</li>
<li>Cartilajul acoperÄƒ suprafeÈ›ele articulare È™i reduce frecarea Ã®n timpul miÈ™cÄƒrii.</li>
<li>MÄƒduva osoasÄƒ roÈ™ie produce celulele sanguine prin procesul de hematopoiezÄƒ.</li>
<li>Oasele stocheazÄƒ minerale importante precum calciul È™i fosforul, reglÃ¢nd nivelul lor Ã®n organism.</li>
</ul>
</div>

<h2>ğŸ“ Test â€“ 9 itemi</h2>
<div class="intrebare">
<p><strong>1. Ce componentÄƒ permite miÈ™carea activÄƒ a corpului?</strong></p>
<div class="raspunsuri">
<button onclick="verifica(this, true)">MuÈ™chii</button>
<button onclick="verifica(this, false)">Oasele</button>
<button onclick="verifica(this, false)">ArticulaÈ›iile</button>
<button onclick="verifica(this, false)">Ligamentele</button>
</div>
</div>
<div class="intrebare">
<p><strong>2. Ce tip de muÈ™chi se contractÄƒ voluntar?</strong></p>
<div class="raspunsuri">
<button onclick="verifica(this, true)">MuÈ™chii striaÈ›i</button>
<button onclick="verifica(this, false)">MuÈ™chiul cardiac</button>
<button onclick="verifica(this, false)">MuÈ™chii netezi</button>
<button onclick="verifica(this, false)">ToÈ›i muÈ™chii</button>
</div>
</div>
<div class="intrebare">
<p><strong>3. CompleteazÄƒ: Oasele craniului protejeazÄƒ __________.</strong></p>
<input id="c1" type="text"/><button onclick="verificaCompletare('c1', 'creierul')">VerificÄƒ</button>
<p class="feedback" id="f1"></p>
</div>
<div class="intrebare">
<p><strong>4. Alege elementele componente ale sistemului locomotor:</strong></p>
<label><input id="cb1" type="checkbox"/> Oase</label><br/>
<label><input id="cb2" type="checkbox"> MuÈ™chi</input></label><br/>
<label><input id="cb3" type="checkbox"/> Ficat</label><br/>
<label><input id="cb4" type="checkbox"/> ArticulaÈ›ii</label><br/>
<button onclick="verificaCheckbox()">VerificÄƒ</button>
<p class="feedback" id="f2"></p>
</div>
<div class="intrebare">
<p><strong>5. CompleteazÄƒ: ArticulaÈ›iile permit __________ Ã®ntre oase.</strong></p>
<input id="c2" type="text"/><button onclick="verificaCompletare('c2', 'miÈ™carea')">VerificÄƒ</button>
<p class="feedback" id="f3"></p>
</div>
<div class="intrebare">
<p><strong>6. Ce sunt muÈ™chii netezi?</strong></p>
<input id="r1" type="text"/><button onclick="verificaScurt()">VerificÄƒ</button>
<p class="feedback" id="f4"></p>
</div>
<div class="intrebare">
<p><strong>7. AsociazÄƒ fiecare componentÄƒ cu funcÈ›ia sa:</strong></p>
<label>Os â†’
        <select id="a1">
<option value="">SelecteazÄƒ</option>
<option value="protectie">ProtecÈ›ie</option>
<option value="contractie">ContracÈ›ie</option>
</select>
</label><br/>
<label>MuÈ™chi â†’
        <select id="a2">
<option value="">SelecteazÄƒ</option>
<option value="protectie">ProtecÈ›ie</option>
<option value="contractie">ContracÈ›ie</option>
</select>
</label><br/>
<button onclick="verificaAsociere()">VerificÄƒ</button>
<p class="feedback" id="f5"></p>
</div>
<div class="intrebare">
<p><strong>8. CompleteazÄƒ: MuÈ™chiul cardiac este un muÈ™chi __________.</strong></p>
<input id="c3" type="text"/><button onclick="verificaCompletare('c3', 'involuntar')">VerificÄƒ</button>
<p class="feedback" id="f6"></p>
</div>
<div class="intrebare">
<p><strong>9. Ce element asigurÄƒ legÄƒtura dintre oase?</strong></p>
<div class="raspunsuri">
<button onclick="verifica(this, false)">MuÈ™chii</button>
<button onclick="verifica(this, false)">Tendonul</button>
<button onclick="verifica(this, false)">Cartilajul</button>
<button onclick="verifica(this, true)">ArticulaÈ›ia</button>
</div>
</div>
<button onclick="afiseazaFeedbackFinal()">âœ… Vezi rezultatul final</button>
<p class="rezultat" id="rezultatFinal"></p>
<a class="back" href="index.html">â† Ãnapoi la meniu</a>
</div>

<script>
    let scor = 0;
    let completari = {};

    function verifica(elem, corect) {
      elem.disabled = true;
      elem.classList.remove('corect', 'gresit');
      elem.classList.add(corect ? 'corect' : 'gresit');
      elem.parentElement.querySelectorAll('button').forEach(b => b.disabled = true);
      if (corect) scor++;
    }

    function verificaCompletare(id, rasp) {
      const val = document.getElementById(id).value.trim().toLowerCase();
      const f = document.getElementById('f' + id.slice(1));
      const esteCorect = val === rasp.toLowerCase();
      f.innerText = esteCorect ? 'âœ”ï¸ Corect' : `âŒ RÄƒspuns corect: ${rasp}`;
      f.style.color = esteCorect ? 'green' : 'red';
      if (!completari[id] && esteCorect) { scor++; completari[id] = true; }
    }

    function verificaCheckbox() {
      const corect = [true, true, false, true];
      const selectat = [cb1.checked, cb2.checked, cb3.checked, cb4.checked];
      const f = document.getElementById('f2');
      const esteCorect = JSON.stringify(corect) === JSON.stringify(selectat);
      f.innerText = esteCorect ? 'âœ”ï¸ Corect' : 'âŒ Componentele corecte: oase, muÈ™chi, articulaÈ›ii.';
      f.style.color = esteCorect ? 'green' : 'red';
      if (esteCorect && !completari['checkbox']) { scor++; completari['checkbox'] = true; }
    }

    function verificaScurt() {
      const val = document.getElementById('r1').value.trim().toLowerCase();
      const f = document.getElementById('f4');
      const esteCorect = val.includes("organe") && val.includes("interne");
      if (esteCorect) {
        f.innerText = 'âœ”ï¸ Corect';
        f.style.color = 'green';
        if (!completari['scurt']) { scor++; completari['scurt'] = true; }
      } else {
        f.innerText = 'âŒ Exemplu: MuÈ™chii netezi acoperÄƒ organele interne È™i se contractÄƒ involuntar.';
        f.style.color = 'red';
      }
    }

    function verificaAsociere() {
      const a1 = document.getElementById('a1').value;
      const a2 = document.getElementById('a2').value;
      const f = document.getElementById('f5');
      const esteCorect = a1 === 'protectie' && a2 === 'contractie';
      f.innerText = esteCorect ? 'âœ”ï¸ Corect' : 'âŒ Os â†’ protecÈ›ie, MuÈ™chi â†’ contracÈ›ie';
      f.style.color = esteCorect ? 'green' : 'red';
      if (esteCorect && !completari['asociere']) { scor++; completari['asociere'] = true; }
    }

    async function adaugaXP(puncte) {
      const user = auth.currentUser;
      if (!user) {
        console.log("Nu eÈ™ti logat, nu se poate salva progresul.");
        return;
      }
      const uid = user.uid;
      const docRef = db.collection("progres_utilizatori").doc(uid);
      try {
        const doc = await docRef.get();
        if (!doc.exists) {
          await docRef.set({ nivel: 1, xp: 0 });
        }
        let data = (await docRef.get()).data();
        let xp = data.xp || 0;
        let nivel = data.nivel || 1;
        const maxXp = nivel * 100;

        xp += puncte;

        if (xp >= maxXp) {
          nivel++;
          xp = xp - maxXp;
          alert(`FelicitÄƒri! Ai urcat la nivelul ${nivel}!`);
        }

        await docRef.update({ nivel, xp });
        console.log(`Progres salvat: Nivel ${nivel}, XP ${xp}/${nivel*100}`);
      } catch (e) {
        console.error("Eroare salvare progres:", e);
      }
    }

    function afiseazaFeedbackFinal() {
      const procent = (scor / 9) * 100;
      let mesaj = '';
      if (procent >= 90) mesaj = 'ğŸŒŸ Excelent! Ai Ã®nÈ›eles foarte bine materia!';
      else if (procent >= 70) mesaj = 'ğŸ‘ Bine! Mai exerseazÄƒ cÃ¢teva concepte.';
      else if (procent >= 50) mesaj = 'ğŸ™‚ Mai este loc de Ã®mbunÄƒtÄƒÈ›ire. ReciteÈ™te lecÈ›ia.';
      else mesaj = 'âš ï¸ ÃÈ›i recomandÄƒm sÄƒ reiei teoria pas cu pas.';
      document.getElementById('rezultatFinal').innerText = `${mesaj} Ai obÈ›inut ${scor} din 9 rÄƒspunsuri corecte.`;

      const xpDeAdaugat = scor * 10; // 10 XP pe rÄƒspuns corect
      adaugaXP(xpDeAdaugat);
    }

    // Google Translate init
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'ro',
        includedLanguages: 'en,hu',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE
      }, 'google_translate_element');
    }

    // Service Worker (PWA)
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/sw.js")
        .then(reg => console.log("âœ… Service Worker activat!", reg))
        .catch(err => console.error("âŒ Eroare la SW:", err));
    }

    // Firebase config È™i iniÈ›ializare
    const firebaseConfig = {
      apiKey: "AIzaSyA5C-UQTHOO7CFrbzV7vMXfQTrM1iz0_CE",
      authDomain: "biobac-cont.firebaseapp.com",
      projectId: "biobac-cont",
      storageBucket: "biobac-cont.appspot.com",
      messagingSenderId: "59421729279",
      appId: "1:59421729279:web:142fbafcc1f22c9b5ac7ca"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Text-to-Speech (TTS)
    const ttsButton = document.getElementById('tts-button');
    let synth = window.speechSynthesis;
    let voceCitita = false;

    ttsButton.addEventListener('click', () => {
      if (voceCitita) {
        synth.cancel();
        ttsButton.textContent = "ğŸ”Š AscultÄƒ";
        voceCitita = false;
      } else {
        let text = document.getElementById('teorie-esentiala').innerText;
        let utterThis = new SpeechSynthesisUtterance(text);
        utterThis.lang = 'ro-RO';
        utterThis.rate = 1;
        utterThis.pitch = 1;
        utterThis.onend = () => {
          ttsButton.textContent = "ğŸ”Š AscultÄƒ";
          voceCitita = false;
        };
        synth.speak(utterThis);
        ttsButton.textContent = "â¸ï¸ OpreÈ™te";
        voceCitita = true;
      }
    });
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script src="settings.js"></script>
</body>
</html>